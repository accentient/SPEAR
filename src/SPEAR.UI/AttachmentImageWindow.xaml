<Window x:Class="UI.AttachmentImageWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Attachment Preview" Height="600" Width="800" ResizeMode="CanResize">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <!-- Use a container to ensure consistent margins/padding for both image and text -->
        <Border Margin="0" Padding="0" Grid.Row="0">
            <Grid>
                <Image x:Name="PreviewImage" Stretch="Uniform" Visibility="Collapsed" Margin="5,5,5,5"/>
                <ScrollViewer Visibility="Collapsed" x:Name="TextScrollViewer">
                    <TextBox x:Name="PreviewText"
                             IsReadOnly="True"
                             TextWrapping="Wrap"
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto"
                             FontFamily="Consolas"
                             FontSize="14"/>
                </ScrollViewer>
            </Grid>
        </Border>
        <Button Content="Close" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="10" Width="100" Height="32" Click="CloseButton_Click" Grid.Row="1"/>
    </Grid>
</Window>